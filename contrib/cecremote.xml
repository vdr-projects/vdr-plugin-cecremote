<?xml version="1.0" encoding="UTF-8"?>
<!--  
	Normally the following cec logical addresses are used:
	0 : TV
	4 : Own libCEC address
	8 : DVD/Blueray player
-->
<config>
	<!-- Key mapping CEC Key to VDR -->
	
	<!-- 
	<ceckeymap id="cecdefault">
		<key code="CEC_USER_CONTROL_CODE_SELECT">
			<value>kOK</value>
		</key>
		<key code="CEC_USER_CONTROL_CODE_RIGHT_UP">
			<value>kRight</value>
			<value>kUp</value>
		</key>
	</ceckeymap>
	-->
	<!-- Key mapping VDR Key to CEC -->
	<!-- 
	<vdrkeymap id="vdrdefault">
		<key code="kOK">
			<value>CEC_USER_CONTROL_CODE_SELECT</value>
		</key>
	</vdrkeymap>
	-->
	<global>
		<cecdebug>7</cecdebug>
		<!--  On VDR start power on TV, make VDR device active -->
		<onstart>
			<poweron>0</poweron>
			<makeactive />
		</onstart>
		<!--  On VDR stop power off TV and DVD/Blueray player -->
		<onstop>
			<poweroff>0</poweroff>
			<poweroff>8</poweroff>
		</onstop>
	</global>
	
	<!--  Menu for TV -->
	<menu name="TV" address="0">
		
		<!--  When menu is selected, switch on and make TV active -->
		<!--  TODO config option for selecting broadcast type -->
		<onstart>
			<poweron>0</poweron>
			<makeinactive />
		</onstart>
		
		<!-- player starts a VDR-Player -->
		<player file="/video/conf/plugins/cecremote/blueray.mpg">
		<!--  <keymaps cec="cecdefault" vdr="vdrdefault" /> -->
			<stop>Stop</stop>
			<stop>Back</stop>
		</player>
		<!--  When returning to VDR poweroff TV and make VDR active -->
		<onstop>
			<poweroff>0</poweroff>
			<makeactive />
		</onstop>
	</menu>
	
	<!--  Menu for Blueray/DVD player -->
	<menu name="Blueray" address="8">
		<!--  When menu is selected, switch on TV and player and make player active -->
		<onstart>
			<poweron>0</poweron>
			<poweron>8</poweron>
		</onstart>
		<player file="/video/conf/plugins/cecremote/blueray.mpg">
		<!--  <keymaps cec="cecdefault" vdr="vdrdefault" /> -->
			<stop>Back</stop>
			<stop>Menu</stop>
		</player>
		<!--  When returning to VDR poweroff DVD Player and make VDR active -->
		<onstop>
			<poweroff>8</poweroff>
			<makeactive />
		</onstop>
	</menu>
	
	<!--  Menu to just power on TV -->
	<menu name="TV ON" address="0">
		<!-- When menu is selected, switch on TV,                    -->
		<!-- leaving VDR the active device. Start no player, no      -->
		<!-- player tag, so that the TV displays the VDR output    -->
		<!-- When player is not used, onstop is ignored            -->
		<onstart>
			<poweron>0</poweron>
		</onstart>
	</menu>
	<!--  Menu to power off TV -->
	<menu name="TV OFF" address="0">
		<!-- When menu is selected, switch off TV        -->
		<onstart>
			<poweroff>0</poweroff>
			<makeactive />
		</onstart>
	</menu>
	
	<!--  Menu to togle power of TV -->
	<menu name="TV TOGGLE" address="0">
		<!-- When menu is selected, toggle TV power state -->
		<onpoweron>
			<!--  Switch on the programmable power outlet for the TV -->
			<exec>sispmctl -o 3</exec>
			<!--  Wait until TV settles -->
			<exec>sleep 10</exec>
			<!--  Send CEC commands to power on TV -->
			<poweron>0</poweron>
			<makeactive />
		</onpoweron>
		<onpoweroff>
		<!--  Send CEC commands to power off TV -->
			<poweroff>0</poweroff>
			<makeactive />
			<!--  Wait until TV finishes switching off -->
			<exec>sleep 10</exec>
			<!--  Switch off the programmable power outlet for the TV -->
			<exec>sispmctl -f 3</exec>
		</onpoweroff>
	</menu>
</config>
